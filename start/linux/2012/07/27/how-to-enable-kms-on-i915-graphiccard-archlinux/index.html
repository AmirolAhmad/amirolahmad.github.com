
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>How to enable KMS on i915 GraphicCard (archlinux)</title>
  <meta name="description" content="Improving your Graphical Performance with this small tip">
  <meta name="author" content="Carlos Alexandro Becker">

  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/themes/twitter/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/themes/twitter/css/body.css" rel="stylesheet">	
  <link href="/assets/themes/twitter/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
  <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
  <link href="/assets/themes/twitter/bootstrap/css/docs.css" rel="stylesheet">
  <script src="/assets/themes/twitter/js/jquery.min.js"></script>
</head>

<body data-spy="scroll" data-offset="50" data-target=".navbar-fixed-top">

<div class="navbar navbar-fixed-top">
	<div class="navbar-inner">
		<div class="container">
			<button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="brand" title="Home" href="/">caarlos0</a>
			<div class="nav-collapse collapse">
				<ul class="nav">
					
					
					


  
    
      
      	<li><a href="/about/index.html" title="About">About</a></li>
      
    
  
    
      
      	<li><a href="/archive.html" title="Archive">Archive</a></li>
      
    
  
    
      
    
  
    
      
      	<li><a href="/categories.html" title="Categories">Categories</a></li>
      
    
  
    
  
    
      
      	<li><a href="/pages.html" title="Pages">Pages</a></li>
      
    
  
    
      
    
  
    
      
      	<li><a href="/tags.html" title="Tags">Tags</a></li>
      
    
  




				</ul>
				<ul class="nav pull-right">
					<li><a href="/atom.xml" title="Atom Feed"><i class="icon-signal"></i> Feed</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>


  
<header class="jumbotron subhead" id="overview">
  <div class="container">
    <h1>How to enable KMS on i915 GraphicCard (archlinux)</h1>
    <p class="lead">Improving your Graphical Performance with this small tip</p>
    <h6>
      Published
      
      
      tagged with 


  
     
    	<a href="/tags.html#archlinux-ref" rel="tooltip" title="see all posts about archlinux"><span class="label label-info">archlinux <span class="tag">3</span></span></a>
    
  



       
      at 27 July 2012
    </h6>
  </div>
</header>
<p />
<div class="container">
  
  <p>Acccording to <a href='https://wiki.archlinux.org/index.php/Kernel_Mode_Setting'>Arch Linux wiki</a>, Kernel Mode Setting (KMS) is a method for setting display resolution and depth in the kernel space rather than user space. KMS enables native resolution in the framebuffer and allows for instant console (tty) switching. KMS also enables newer technologies (such as DRI2) which will help reduce artifacts and increase 3D performance, even kernel space power-saving.</p>

<p>So, you can see this is a good thing, uh? I&#8217;ll show you the steps needed to activate this for my GraphicCard.</p>

<h2 id='check_if_kms_is_active'>Check if KMS is active</h2>

<p>If the following command return <code>1</code>, your KMS module is already active, and you can go and drink a coffee. Otherwise, goto the next steps.</p>

<pre><code>$ cat /sys/module/i915/parameters/modeset</code></pre>

<h2 id='install_required_packages'>Install required packages</h2>

<p>Before continue, be sure that the following packages are installed:</p>

<pre><code>xf86-video-fbdev
xf86-video-intel
xf86-video-vesa</code></pre>

<p>You can install it in a archlinux box with <code>$ pacman -Sy xf86-video-{fbdev,intel,vesa}</code></p>

<h2 id='edit_files'>Edit files</h2>

<p>You will need to change several files. Starting with <code>/etc/modprobe.d/modprobe.conf</code>. Add (or create the file, if it doesn&#8217;t exist) the following:</p>

<pre><code>options i915 modeset=1</code></pre>

<p>Also, edit <code>/etc/mkinitcpio.conf</code>.</p>

<ul>
<li>Edit the <code>MODULES</code> line, like in <code>MODULES=&quot;intel_agp i915&quot;</code></li>

<li>Uncoment the line <code>FILES=&quot;/etc/modprobe.d/modprobe.conf&quot;</code> and comment the <code>FILES=&quot;&quot;</code> if it exists.</li>
</ul>

<p>Create the <code>/etc/X11/xorg.conf.d/20-intel.conf</code> file with the following content:</p>

<pre><code>Section &quot;Device&quot;
	Identifier &quot;card0&quot;
	Driver &quot;intel&quot;
	VendorName  &quot;Intel Corporation&quot;
	BoardName   &quot;Intel Corporation N10 Family Integrated Graphics Controller&quot;
	BusID       &quot;PCI:0:2:0&quot;
	Option      &quot;SwapbuffersWait&quot;    &quot;false&quot;
EndSection</code></pre>

<h2 id='regenerate_initframs'>Regenerate initframs</h2>

<p>Now, we can regen initframs with</p>

<pre><code>$ sudo mkinitcpio -p linux</code></pre>

<h2 id='reboot'>Reboot</h2>

<p>Now, reboot your system, and when it cames up, run the first command again, and see if it returns <code>1</code> this time.</p>

<p>Also, this is my <code>lspci</code>:</p>

<pre><code>$ lspci | grep -i vga
	00:02.0 VGA compatible controller: Intel Corporation Core Processor Integrated Graphics Controller (rev 18)</code></pre>

<p>That&#8217;s it. See ya.</p>

  

  <hr class="soften">
  <h2>Related Posts</h2>
    
      <a href="/linux/2012/08/02/linux-and-mtp-just-a-hell">Linux and MTP: Just a hell</a><br />
    
      <a href="/linux/2012/07/31/updating-arch-linux-from-a-core-install">Updating Arch Linux from a Core Install</a><br />
    
  </hr>


  <hr class="soften">

  <div class="well row-fluid">
    <ul class="thumbnails">
      <li class="span2 avatar-span2" >
	<a href="/about" class="thumbnail" rel="tooltip" title="see more info...">
	  <img src="http://www.gravatar.com/avatar/7ef3cd04888c6d17f34d43e29ec3d46f?rating=PG&amp;size=150" alt="Avatar">
	</a>
      </li>
      <li class="span10">
	<h2>About the Author</h2>
	<br />
	<p>
	  <a href="/about" title="see more info">Carlos</a> works in a <a href="http://www.ciphersec.com.br/"> security information company</a>, coding mostly Java (2+ years exp). 
	  He also worked in a lot of other projects using GWT, JSF, and others.
	  Like to pass some hours hacking around Maven and having ideas of cool and helpfull thing to code, but, have no much time to do this...
	  Creator, Architect and developer of <a title="see the demo!" href="http://gwtbootstrap.github.com">GWT-Bootstrap</a> Project. 
	  At the moment, studying Ruby and Ruby on Rails. 
	  He's also Linux and Android user.
	</p>
      </li>
    </ul>
  </div>

  <div class="pagination">
    <ul>
      
	<li class="prev"><a href="/code/2012/06/27/using-a-custom-bootstrap-theme-in-gwt-bootstrap" title="Using a custom TwBootstrap's theme in GWT-Bootstrap">&larr; Previous</a></li>
      
	<li><a href="/archive.html">Archive</a></li>
      
	<li class="next"><a href="/linux/2012/07/31/updating-arch-linux-from-a-core-install" title="Updating Arch Linux from a Core Install">Next &rarr;</a></li>
      
    </ul>
  </div>

  <hr class="soften">

  <!-- AddThis Button BEGIN -->
  <div class="addthis_toolbox addthis_default_style ">
    <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    <a class="addthis_button_tweet"></a>
    <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    <a class="addthis_counter addthis_pill_style"></a>
  </div>

  <script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=caarlos0"></script>
  <!-- AddThis Button END -->

  <hr class="soften" />

  


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'caarlos0blog'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




</div> <!-- /container --> 


<style type="text/css">body{padding-top: 30px; }</style>

  
  <footer class="footer">
    <div class="container">
		  <p class="pull-right"><a href="#" onclick="$('html, body').animate({scrollTop: $('body').offset().top }, 2000);">Back to top</a></p>
		  <p>
		    All posts are written by <a href="/about">Carlos Alexandro Becker</a>
		    and are licenced under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
		  </p>
		  <p>
		    Thanks to <a href="http://jekyllbootstrap.com" target="_blank" rel="tooltip" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a> and 
		    <a href="http://twitter.github.com/bootstrap/" target="_blank" rel="tooltip" title="Simple and flexible HTML, CSS, and Javascript for popular user interface components and interactions.">Twitter Bootstrap</a>
		  </p>
		  <h4>Blogroll</h4>
		  <ul class="footer-links">
		    <li><a href="http://www.carlos.inf.br/">Carlos Cabelo</a></li>
		    <li><a href="http://byfat.xxx/">By Fat</a></li>
		    <li><a href="http://blog.getbootstrap.com/">Twitter Bootstrap</a></li>
		  </ul>
    </div>
  </footer>

  

  <script src="/assets/themes/twitter/bootstrap/js/bootstrap.min.js"></script>
  <script>
    $('.content a[title]').each(function(){ $(this).attr('rel', 'tooltip'); });
    $('.navbar a[title]').each(function(){$(this).attr('rel', 'tooltip'); $(this).attr('data-placement', 'bottom');});
    $('[rel=tooltip]').tooltip();
  </script>
</body>
</html>

